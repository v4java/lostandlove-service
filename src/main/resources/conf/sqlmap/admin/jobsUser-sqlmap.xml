<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.v4java.lal.dao.JobsUserDao" >

  <resultMap id="jobsUser-resultMap" type="jobsUser" >

    <id 	column="id" 			property="id" 			jdbcType="INTEGER" />
    <result column="jobs_id" 		property="jobsId" 		jdbcType="INTEGER" />
    <result column="user_code" 		property="userCode" 	jdbcType="VARCHAR" />
    <result column="user_name" 		property="userName" 	jdbcType="VARCHAR" />
    <result column="status" 		property="status" 		jdbcType="INTEGER" />
    
    <result column="create_time" 	property="createTime" 	jdbcType="TIMESTAMP" />
    <result column="update_time" 	property="updateTime" 	jdbcType="TIMESTAMP" />

  </resultMap>
  
  <resultMap type="workFlowVO" id="workFlowVO-resultMap">
  	<id 	column="id" 					property="id" 				jdbcType="INTEGER" />
    <result column="busy_type_id" 			property="busyTypeId" 		jdbcType="INTEGER" />
    <result column="model_id" 				property="modelId" 			jdbcType="INTEGER" />
    <result column="name" 					property="name" 			jdbcType="VARCHAR" />
    <result column="description" 			property="description" 		jdbcType="VARCHAR" />
    	
    <result column="create_time" 			property="createTime" 		jdbcType="TIMESTAMP" />
    <result column="update_time" 			property="updateTime" 		jdbcType="TIMESTAMP" />
    <result column="jobs_name" 				property="jobsName" 		jdbcType="VARCHAR" />
    <result column="jobs_description" 		property="jobsDescription" 	jdbcType="VARCHAR" />
    
  </resultMap>
  
  	<select id="findUserWorkFlowVOByUserId" parameterType="string" resultMap="jobsUser-resultMap">
  		select 
  				wf.id,wf.busy_type_id,wf.name,wf.model_id,wf.description ,
  				wf.create_time ,wf.update_time,j.jobs_name , j.jobs_description 
  		from 
  				jobs_user ju 
  		left join 
  				 workflow wf on wf.jobs_id = ju.jobs_id
  		left join 
  				jobs j on j.id = ju.jobs_id
  				
  		where 
  				ju.user_code = #{userCode}	
  	</select>
  	
  	<insert id="batchInsertJobsUser" parameterType="list">
  		insert into jobs_user(
  				jobs_id,user_code,user_name,status)
  		  values 
	    <foreach collection ="list" item ="item" index ="index" separator =","> 
	       	(#{item.jobsId}, #{item.userCode} ,#{item.userName},0) 
	    </foreach>
    
  	</insert>
  
</mapper>